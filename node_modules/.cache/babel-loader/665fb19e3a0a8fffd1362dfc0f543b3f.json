{"ast":null,"code":"import _regeneratorRuntime from\"/Users/nastassianguyen/Desktop/proj/EagleTracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _createForOfIteratorHelper from\"/Users/nastassianguyen/Desktop/proj/EagleTracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _asyncToGenerator from\"/Users/nastassianguyen/Desktop/proj/EagleTracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _objectSpread from\"/Users/nastassianguyen/Desktop/proj/EagleTracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"/Users/nastassianguyen/Desktop/proj/EagleTracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/nastassianguyen/Desktop/proj/EagleTracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/nastassianguyen/Desktop/proj/EagleTracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/nastassianguyen/Desktop/proj/EagleTracker/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{jsx as _jsx}from\"react/jsx-runtime\";/* \nfile: App.tsx \n    main file for the navigation between home page and view all\n    displays the 'home' and 'view all' buttons\n    contains router implementation\n*/import React,{Component}from'react';import'./App.css';import{UserApi}from\"./lb-api\";import{Configuration}from\"./lb-api/configuration\";import{BrowserRouter as Router,Route,Switch}from\"react-router-dom\";import Dashboard from\"./Dashboard\";import ViewAll from\"./ViewAll\";import Loading from'./components/loading';import Card from'./cards';export var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.renderDevices=function(routerProps){var deviceID=parseInt(routerProps.match.params.id);var foundDevice=_this.state.items.find(function(device){return device.id===deviceID;});return foundDevice?/*#__PURE__*/_jsx(Card,_objectSpread({},foundDevice)):/*#__PURE__*/_jsx(Loading,{});};_this.state={items:[]};return _this;}// get list of devices\n_createClass(App,[{key:\"getDevices\",value:function(){var _getDevices=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var config,userApi,token,allDevices,items,_iterator,_step,device;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;config=new Configuration();userApi=new UserApi(config);_context.prev=3;_context.next=6;return userApi.userLogin({username:process.env.REACT_APP_LIGHTBUG_API_USERNAME,password:process.env.REACT_APP_LIGHTBUG_API_PASSWORD});case 6:token=_context.sent;config.accessToken=token.id;config.userId=\"\".concat(token.userId);_context.next=16;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](3);console.error('Login Failed');alert('Login Fail');return _context.abrupt(\"return\");case 16:_context.next=18;return userApi.userPrototypeGetDevices(config.userId,JSON.stringify({where:{lastConnection:{gt:+new Date()-7*24*3600*1000}}}));case 18:allDevices=_context.sent;items=[];_iterator=_createForOfIteratorHelper(allDevices);_context.prev=21;_iterator.s();case 23:if((_step=_iterator.n()).done){_context.next=30;break;}device=_step.value;if(device.id){_context.next=27;break;}return _context.abrupt(\"continue\",28);case 27:// prevent error on next line\nitems.push(device);case 28:_context.next=23;break;case 30:_context.next=35;break;case 32:_context.prev=32;_context.t1=_context[\"catch\"](21);_iterator.e(_context.t1);case 35:_context.prev=35;_iterator.f();return _context.finish(35);case 38:this.setState({items:items});_context.next=44;break;case 41:_context.prev=41;_context.t2=_context[\"catch\"](0);console.error(\"Failed to get data\",_context.t2);case 44:case\"end\":return _context.stop();}}},_callee,this,[[0,41],[3,11],[21,32,35,38]]);}));function getDevices(){return _getDevices.apply(this,arguments);}return getDevices;}()// returns promise after component mounts to DOM\n},{key:\"componentDidMount\",value:function componentDidMount(){this.getDevices().then();}// renderDevices function to display the card component \n},{key:\"render\",// render function -- renders out what to display on screen\nvalue:function render(){var _this2=this;return/*#__PURE__*/_jsxs(Router,{children:[/*#__PURE__*/_jsxs(\"header\",{children:[/*#__PURE__*/_jsx(\"a\",{className:\"button\",href:\"/\",children:\"Home\"}),/*#__PURE__*/_jsx(\"a\",{className:\"button\",href:\"/view-all\",children:\"View All\"})]}),/*#__PURE__*/_jsxs(Switch,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",exact:true,component:Dashboard}),/*#__PURE__*/_jsx(Route,{path:\"/devices/:id\",render:function render(routerProps){return _this2.renderDevices(routerProps);}}),/*#__PURE__*/_jsx(Route,{path:\"/view-all\",component:ViewAll})]})]});}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/Users/nastassianguyen/Desktop/proj/EagleTracker/src/App.tsx"],"names":["React","Component","UserApi","Configuration","BrowserRouter","Router","Route","Switch","Dashboard","ViewAll","Loading","Card","App","props","renderDevices","routerProps","deviceID","parseInt","match","params","id","foundDevice","state","items","find","device","config","userApi","userLogin","username","process","env","REACT_APP_LIGHTBUG_API_USERNAME","password","REACT_APP_LIGHTBUG_API_PASSWORD","token","accessToken","userId","console","error","alert","userPrototypeGetDevices","JSON","stringify","where","lastConnection","gt","Date","allDevices","push","setState","getDevices","then"],"mappings":"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","sourcesContent":["/* \nfile: App.tsx \n    main file for the navigation between home page and view all\n    displays the 'home' and 'view all' buttons\n    contains router implementation\n*/\n\nimport React, {Component} from 'react';\nimport './App.css';\nimport {UserApi} from \"./lb-api\";\nimport {Configuration} from \"./lb-api/configuration\";\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\nimport Dashboard from \"./Dashboard\";\nimport ViewAll from \"./ViewAll\";\nimport Loading from './components/loading';\nimport Card from './cards';\n\nexport class App extends Component<{}, { items : any }> {\n    constructor(props:any) {\n        super(props);\n        this.state = { items: [] };\n    }\n\n    // get list of devices\n    async getDevices() {\n        try {\n            const config = new Configuration();\n            const userApi = new UserApi(config);\n            try {\n                let token = await userApi.userLogin({username: process.env.REACT_APP_LIGHTBUG_API_USERNAME, password: process.env.REACT_APP_LIGHTBUG_API_PASSWORD});\n                config.accessToken = token.id;\n                config.userId = `${token.userId}`;\n\n            } catch {\n                console.error('Login Failed')\n                alert('Login Fail');\n                return;\n            }\n\n            let allDevices = await userApi.userPrototypeGetDevices(config.userId,\n                JSON.stringify({where: {lastConnection : {gt: +new Date() - 7 * 24 * 3600 * 1000} }})\n            );\n\n            const items: any[] = [];\n            for (const device of allDevices) {\n                if (!device.id) continue; // prevent error on next line\n                items.push(device)\n            }\n\n            this.setState({items});\n        } catch (e) {\n            console.error(\"Failed to get data\", e);\n        }\n    }\n\n    // returns promise after component mounts to DOM\n    componentDidMount() {\n        this.getDevices().then();\n    }\n\n    // renderDevices function to display the card component \n    renderDevices = (routerProps) => {\n        let deviceID = parseInt(routerProps.match.params.id);\n        let foundDevice = (this.state as any).items.find(device => device.id === deviceID);\n        return (\n            foundDevice ? <Card {...foundDevice}/> : <Loading/>\n            );\n      }\n\n    // render function -- renders out what to display on screen\n    render() {\n        return (\n            <Router> \n                <header>\n                    <a className=\"button\" href=\"/\">Home</a>\n                    <a className=\"button\" href=\"/view-all\">View All</a>\n                </header>\n                <Switch>\n                        <Route path=\"/\" exact component={Dashboard} />\n                        <Route path = '/devices/:id' render = {routerProps => this.renderDevices(routerProps)} />\n                        <Route path=\"/view-all\"  component={ViewAll} />\n                    </Switch>\n            </Router>\n           );\n    }\n}\n\n  export default App;"]},"metadata":{},"sourceType":"module"}